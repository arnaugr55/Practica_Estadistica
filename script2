---
title: "practicaes"
author: "Santi Pérez"
date: "1/5/2022"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r inicilization code}
library(boot)
library(lpSolve)
library(rootSolve)
library(Matrix)
library(calculus)
library(magrittr)

pokemon=read.csv("pokemon_alopez247.csv",header=TRUE)

print("Filtrat pokemon primera generació")
pokemon2 <- pokemon[0:151,0:23]

print("Afegides columnes amb la importància de cada stat en el pokémon")
total = pokemon2$Total
pokemon2["perc_HP"] <- round((pokemon2$HP / total)*100)
pokemon2["perc_Attack"] <- round((pokemon2$Attack / total)*100)
pokemon2["perc_Defense"] <- round((pokemon2$Defense / total)*100)
pokemon2["perc_Sp_Atk"] <- round((pokemon2$Sp_Atk / total)*100)
pokemon2["perc_Sp_Def"] <- round((pokemon2$Sp_Def / total)*100)
pokemon2["perc_Speed"] <- round((pokemon2$Speed / total)*100)

pokemon3 <- pokemon[0:151,5:11]
pokemon3["Number"]       = pokemon2$Number
pokemon3["Pr_Male"]      = pokemon2$Pr_Male
pokemon3["Height_m"]     = pokemon2$Height_m
pokemon3["Weight_kg"]    = pokemon2$Weight_kg
pokemon3["Catch_Rate"]   = pokemon2$Catch_Rate
pokemon3["perc_HP"]      = pokemon2$perc_HP
pokemon3["perc_Attack"]  = pokemon2$perc_Attack
pokemon3["perc_Defense"] = pokemon2$perc_Defense
pokemon3["perc_Sp_Atk"]  = pokemon2$perc_Sp_Atk
pokemon3["perc_Sp_Def"]  = pokemon2$perc_Sp_Def
pokemon3["perc_Speed"]   = pokemon2$perc_Speed

pokemon4=pokemon2[pokemon2$Type_1=="Water" | pokemon2$Type_1=="Grass" | pokemon2$Type_1=="Fire",]
factors=factor(pokemon4$Type_1)
tipus=as.numeric(factors)
pokemon4["tipus"] = tipus
pokemon4[is.na(pokemon4)]=0
pokemon4

```

```{r 0 code}
#Matriz de varianzas y covarianzas
cova=cov(pokemon3)
cova[is.na(cova)] = 0
heatmap(cova)
print("-----")
#Matriz que muestra correlación entre x e y
corr=cor(pokemon3)
corr[is.na(corr)] = 0
heatmap(corr)
print("-----")
```



```{r 1 code}
print("Primer objectiu (Relació Catch_Rate i les 6 estadístiques")
#Gràfiques

pokemon2

print("Histograma del HP")
hist(pokemon2$HP)
print("Histograma del atac")
hist(pokemon2$Attack)
print("Histograma del defensa")
hist(pokemon2$Defense)
print("Histograma del atac especial")
hist(pokemon2$Sp_Atk)
print("Histograma del defensa especial")
hist(pokemon2$Sp_Def)
print("Histograma del velocitat")
hist(pokemon2$Speed)
print("Histograma del catch_rate")
hist(pokemon2$Catch_Rate)
print("Gràfica relació HP amb catch_rate")
plot(pokemon2$HP,pokemon2$Catch_Rate,type = "p", main = "Relació HP amb catch_rate", xlab = "HP", ylab = "Catch_Rate")
print("Gràfica relació atac amb catch_rate")
plot(pokemon2$Attack,pokemon2$Catch_Rate,type = "p", main = "Relació atac amb catch_rate", xlab = "Atac", ylab = "Catch_Rate")
print("Gràfica relació defensa amb catch_rate")
plot(pokemon2$Defense,pokemon2$Catch_Rate,type = "p", main = "Relació defensa amb catch_rate", xlab = "Defensa", ylab = "Catch Rate")
print("Gràfica relació atac especial amb catch_rate")
plot(pokemon2$Sp_Atk,pokemon2$Catch_Rate,type = "p", main = "Relació atac especial amb catch_rate", xlab = "Atac Especial", ylab = "Catch Rate")
print("Gràfica relació defensa especial amb catch_rate")
plot(pokemon2$Sp_Def,pokemon2$Catch_Rate,type = "p", main = "Relació defensa especial amb catch_rate", xlab = "Defensa especial", ylab = "Catch Rate")
print("Gràfica relació velocitat amb catch_rate")
plot(pokemon2$Speed,pokemon2$Catch_Rate,type = "p", main = "Relació velocitat amb catch_rate", xlab = "Velocitat", ylab = "Catch Rate")
print("Anova")
anova=aov(Catch_Rate~HP+Attack+Defense+Sp_Atk+Sp_Def+Speed,data=pokemon2)
summary(anova)
print("Model Lineal Generalitzat")
modg=glm(Catch_Rate~HP+Attack+Defense+Sp_Atk+Sp_Def+Speed,family = poisson, data=pokemon2)
summary(modg)
print("acdvdvdv")
aov(modg)
print("-----")
confint(modg)
print("-----")
exp(coef(modg))

```

```{r 2 code}
#He separat els pokemons de tipus aigua i els de tipus normal
#I amb un label encoder he fet que els de tipus Aigua siguin un 1 i els de tipus Normal siguin amb un 0 
pokemon4
print("Grafica Atack")
plot(pokemon4$Attack,pokemon4$tipus, type = "p", xlab = "Atack", ylab = "Foc=1, Planta=2, Aigua=3")
print("Grafica Defense")
plot(pokemon4$Defense,pokemon4$tipus, type = "p", xlab = "Defense", ylab = "Foc=1, Planta=2, Aigua=3")
print("Grafica Spe_Atack")
plot(pokemon4$Sp_Atk,pokemon4$tipus, type = "p", xlab = "Special Atack", ylab = "Foc=1, Planta=2, Aigua=3")
print("Grafica Spe_Atack")
plot(pokemon4$Sp_Def,pokemon4$tipus, type = "p", xlab = "Special Defense", ylab = "Foc=1, Planta=2, Aigua=3")
print("Grafica HP")
plot(pokemon4$HP,pokemon4$tipus, type = "p", xlab = "HP", ylab = "Foc=1, Planta=2, Aigua=3")
print("Grafica Speed")
plot(pokemon4$Speed,pokemon4$tipus, type = "p", xlab = "Speed", ylab = "Foc=1, Planta=2, Aigua=3")


print("Anova")
anova=aov(tipus~HP+Attack+Defense+Sp_Atk+Sp_Def+Speed,data=pokemon4)
summary(anova)

print("Model Regressió Logística")
modg=lm(tipus~HP+Attack+Defense+Sp_Atk+Sp_Def+Speed,family = binomial, data=pokemon4)
summary(modg)
print("acdvdvdv")
aov(modg)
print("-----")
confint(modg)
print("-----")
exp(coef(modg))
print("Model Regressió Poisson")
modg2=lm(tipus~HP+Attack+Defense+Sp_Atk+Sp_Def+Speed,family = poisson, data=pokemon4)
summary(modg2)
print("acdvdvdv")
aov(modg2)
print("-----")
confint(modg2)
print("-----")
exp(coef(modg2))

#Matriu variances i covariances
#pokemon5=pokemon3[pokemon2$Type_1=="Water" | pokemon2$Type_1=="Grass" | pokemon2$Type_1=="Fire",]
#cova=cov(pokemon3)
#cova[is.na(cova)] = 0
#heatmap(cova)

```
