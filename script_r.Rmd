---
title: "Pràctica Anàlisi Estadística"
author: "Arnau Garriga Riba, Santiago Pérez Lete"
date: "13/1/2022"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r 1 code}
library(boot)
library(lpSolve)
library(rootSolve)
library(Matrix)
library(calculus)
library(magrittr)

pokemon=read.csv("Documents/3r/AE/practica/pokemon_alopez247.csv",header=TRUE)

print("filtrat pokemon primera generació")
pokemon2 <- pokemon[0:151,0:23]

print("Afegides columnes amb la importància de cada stat en el pokémon")
total = pokemon2$Total
pokemon2["%_HP"] <- pokemon2$HP / total
pokemon2["%_Attack"] <- pokemon2$Attack / total
pokemon2["%_Defense"] <- pokemon2$Defense / total
pokemon2["%_Sp_Atk"] <- pokemon2$Sp_Atk / total
pokemon2["%_Sp_Def"] <- pokemon2$Sp_Def / total
pokemon2["%_Speed"] <- pokemon2$Speed / total
pokemon2

print("Primer objectiu (Relació pes i altura amb el catch_rate)")
print("Anova")
anova=aov(Catch_Rate~Height_m+Weight_kg,data=pokemon2)
summary(anova)
print("Model Lineal Generalitzat")
modg=glm(Catch_Rate~Height_m+Weight_kg,family = poisson, data=pokemon2)
summary(modg)
print("acdvdvdv")
aov(modg)
print("-----")
confint(modg)
print("-----")
exp(coef(modg))
print("-----")
#Matriz de varianzas y covarianzas
cov(pokemon2)
print("-----")
#Matriz 
#cov(modg)
print("-----")
#Matriz que muestra correlación entre x e y
cor(pokemon2)
print("-----")
```



```{r 2 code}
library(boot)
library(lpSolve)
library(rootSolve)
library(Matrix)
library(calculus)
library(magrittr)

pokemon=read.csv("Documents/3r/AE/practica/pokemon_alopez247.csv",header=TRUE)
print("filtrat pokemon primera generació")
pokemon2 <- pokemon[0:151,0:23]

print("Afegides columnes amb la importància de cada stat en el pokémon")
total = pokemon2$Total
pokemon2["%_HP"] <- pokemon2$HP / total
pokemon2["%_Attack"] <- pokemon2$Attack / total
pokemon2["%_Defense"] <- pokemon2$Defense / total
pokemon2["%_Sp_Atk"] <- pokemon2$Sp_Atk / total
pokemon2["%_Sp_Def"] <- pokemon2$Sp_Def / total
pokemon2["%_Speed"] <- pokemon2$Speed / total
pokemon2

print("Primer objectiu (Relació Defensa i Defensa especial amb l'HP)")
print("Anova")
anova=aov(HP~Defense+Sp_Def,data=pokemon2)
summary(anova)
print("Model Lineal Generalitzat")
modg=glm(HP~Defense+Sp_Def,family = poisson, data=pokemon2)
summary(modg)
print("acdvdvdv")
aov(modg)
print("-----")
confint(modg)
print("-----")
exp(coef(modg))
print("-----")
#Matriz de varianzas y covarianzas
cov(pokemon2)
print("-----")
#Matriz 
#cov(modg)
print("-----")
#Matriz que muestra correlación entre x e y
cor(pokemon2)
print("-----")
```

```{r 3 code}
library(boot)
library(lpSolve)
library(rootSolve)
library(Matrix)
library(calculus)
library(magrittr)

pokemon=read.csv("Documents/3r/AE/practica/pokemon_alopez247.csv",header=TRUE)
print("filtrat pokemon primera generació")
pokemon2 = pokemon[0:151,0:23]
pokemon2
print("Primer objectiu (Relació Pr_Male amb l'HP)")
print("Anova")
anova=aov(HP~Pr_Male,data=pokemon2)
summary(anova)
print("Model lineal simple")
model=lm(HP~Pr_Male,data=pokemon2)
model
summary(model)
print("acdvdvdv")
aov(model)
print("-----")
confint(model)
print("-----")
exp(coef(model))
```
